<project
   xmlns:j="jelly:core"
   xmlns:maven="jelly:maven"
  >

   <!--
    |
    | Create the additional jars...
    | acegi-security.jar will be created as the default project artifact.
    |
    -->
   <preGoal name="jar:jar">

      <!--
       | The Acegi Security Tag Library JAR
       -->
      <jar jarfile="${maven.build.dir}/acegi-taglib-${pom.currentVersion}.jar">
         <fileset dir="${maven.build.dest}">
            <include name="net/sf/acegisecurity/taglibs/**"/>
            <exclude name="**/*.tld"/>
         </fileset>
         <zipfileset dir="${maven.src.dir}/net/sf/acegisecurity/taglibs"
            prefix="META-INF" includes="*.tld" />
         <manifest>
            <attribute name="Acegi-Security-System-version" value="${pom.currentVersion}"/>
            <attribute name="Sealed" value="true"/>
         </manifest>
      </jar>

      <!--
       | The class that has catalina.jar dependencies and thus belongs in
       | Catalina's "Catalina" classloader ($CATALINA_HOME/server/lib directory)
       -->
      <jar jarfile="${maven.build.dir}/acegi-security-catalina-server-${pom.currentVersion}.jar">
         <fileset dir="${maven.build.dest}">
            <include name="net/sf/acegisecurity/adapters/catalina/CatalinaAcegiUserRealm.class"/>
         </fileset>
         <manifest>
            <attribute name="Acegi-Security-System-version" value="${pom.currentVersion}"/>
         </manifest>
      </jar>

      <!--
       | All Acegi Security System for Spring classes that belong in Catalina's
       | "Common" classloader ($CATALINA_HOME/common/lib directory)
       -->
      <jar jarfile="${maven.build.dir}/acegi-security-catalina-common-${pom.currentVersion}.jar">
         <fileset dir="${maven.build.dest}">
            <include name="net/sf/acegisecurity/*"/>
            <include name="net/sf/acegisecurity/context/**"/>
            <include name="net/sf/acegisecurity/providers/**"/>
            <include name="net/sf/acegisecurity/runas/**"/>
            <include name="net/sf/acegisecurity/vote/**"/>
            <include name="net/sf/acegisecurity/ui/**"/>
            <include name="net/sf/acegisecurity/util/**"/>
            <include name="net/sf/acegisecurity/securechannel/**"/>
            <include name="net/sf/acegisecurity/intercept/**"/>
            <include name="net/sf/acegisecurity/adapters/*"/>
            <include name="net/sf/acegisecurity/adapters/catalina/*"/>
            <exclude name="net/sf/acegisecurity/adapters/catalina/CatalinaAcegiUserRealm.class"/>
         </fileset>
         <manifest>
            <attribute name="Acegi-Security-System-version" value="${pom.currentVersion}"/>
         </manifest>
      </jar>

      <!--
       | All Acegi Security System for Spring classes that belong in Jetty's
       | "ext" directory
       -->
      <jar jarfile="${maven.build.dir}/acegi-security-jetty-ext-${pom.currentVersion}.jar">
         <fileset dir="${maven.build.dest}">
            <include name="net/sf/acegisecurity/*"/>
            <include name="net/sf/acegisecurity/context/**"/>
            <include name="net/sf/acegisecurity/providers/**"/>
            <include name="net/sf/acegisecurity/runas/**"/>
            <include name="net/sf/acegisecurity/vote/**"/>
            <include name="net/sf/acegisecurity/ui/**"/>
            <include name="net/sf/acegisecurity/util/**"/>
            <include name="net/sf/acegisecurity/securechannel/**"/>
            <include name="net/sf/acegisecurity/intercept/**"/>
            <include name="net/sf/acegisecurity/adapters/*"/>
            <include name="net/sf/acegisecurity/adapters/jetty/*"/>
         </fileset>
         <manifest>
            <attribute name="Acegi-Security-System-version" value="${pom.currentVersion}"/>
         </manifest>
      </jar>

      <!--
       | All Acegi Security System for Spring classes that belong in JBoss'
       | "server/your_config/lib" directory
       -->
      <jar jarfile="${maven.build.dir}/acegi-security-jboss-lib-${pom.currentVersion}.jar">
         <fileset dir="${maven.build.dest}">
            <include name="net/sf/acegisecurity/*"/>
            <include name="net/sf/acegisecurity/context/**"/>
            <include name="net/sf/acegisecurity/providers/**"/>
            <include name="net/sf/acegisecurity/runas/**"/>
            <include name="net/sf/acegisecurity/vote/**"/>
            <include name="net/sf/acegisecurity/ui/**"/>
            <include name="net/sf/acegisecurity/util/**"/>
            <include name="net/sf/acegisecurity/securechannel/**"/>
            <include name="net/sf/acegisecurity/intercept/**"/>
            <include name="net/sf/acegisecurity/adapters/*"/>
            <include name="net/sf/acegisecurity/adapters/jboss/*"/>
         </fileset>
         <manifest>
            <attribute name="Acegi-Security-System-version" value="${pom.currentVersion}"/>
         </manifest>
      </jar>

      <!--
       | All Acegi Security System for Spring classes that belong in
       | Resin's "lib" directory
       -->
      <jar jarfile="${maven.build.dir}/acegi-security-resin-lib-${pom.currentVersion}.jar">
         <fileset dir="${maven.build.dest}">
            <include name="net/sf/acegisecurity/*"/>
            <include name="net/sf/acegisecurity/context/**"/>
            <include name="net/sf/acegisecurity/providers/**"/>
            <include name="net/sf/acegisecurity/runas/**"/>
            <include name="net/sf/acegisecurity/vote/**"/>
            <include name="net/sf/acegisecurity/ui/**"/>
            <include name="net/sf/acegisecurity/util/**"/>
            <include name="net/sf/acegisecurity/securechannel/**"/>
            <include name="net/sf/acegisecurity/intercept/**"/>
            <include name="net/sf/acegisecurity/adapters/*"/>
            <include name="net/sf/acegisecurity/adapters/resin/*"/>
         </fileset>
         <manifest>
            <attribute name="Acegi-Security-System-version" value="${pom.currentVersion}"/>
         </manifest>
      </jar>

   </preGoal>

</project>
